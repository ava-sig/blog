import{k as g}from"./CAjE_Kqs.js";function w(){const h=g().public?.apiBase||"";async function i(t,o,a){const f=`${h.replace(/\/$/,"")}/api${o}`,c={"Content-Type":"application/json"};try{if(typeof window<"u"){const s=sessionStorage.getItem("auth.session")==="1",n=localStorage.getItem("token")||"";s&&n&&(c.Authorization=`Bearer ${n}`)}}catch{}const e=await fetch(f,{method:t,headers:c,body:a!==void 0?JSON.stringify(a):void 0});if(!e.ok){const n=await e.text().catch(()=>"")||`${e.status} ${e.statusText}`;throw new Error(`${t} ${f} -> ${n}`)}if(e.status===204)return;const r=e.headers.get("content-type")||"";if(/json/i.test(r))return e.json()}return{get:t=>i("GET",t),post:(t,o)=>i("POST",t,o),put:(t,o)=>i("PUT",t,o),del:t=>i("DELETE",t),async upload(t,o,a){const c=g().public?.apiBase||"";let e="";if(typeof window<"u")try{const p=sessionStorage.getItem("auth.session")==="1",d=localStorage.getItem("token");p&&d&&(e=d)}catch{}const r=`${String(c).replace(/\/$/,"")}${t}`,s=new FormData;s.append(o,a);const n={};e&&(n.Authorization=`Bearer ${e}`);const u=await fetch(r,{method:"POST",headers:n,body:s});if(!u.ok){const p=await u.text().catch(()=>"");throw new Error(`UPLOAD ${r} -> ${p||u.status}`)}return u.json()}}}export{w as u};
